<!DOCTYPE html><html class="default" lang="en" data-base="../"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>React | @karmaniverous/rrstack</title><meta name="description" content="Documentation for @karmaniverous/rrstack"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => window.app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><a href="../index.html" class="title">@karmaniverous/rrstack</a><div id="tsd-toolbar-links"><a href="https://github.com/karmaniverous/rrstack">GitHub</a></div><button id="tsd-search-trigger" class="tsd-widget" aria-label="Search"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></button><dialog id="tsd-search" aria-label="Search"><input role="combobox" id="tsd-search-input" aria-controls="tsd-search-results" aria-autocomplete="list" aria-expanded="true" autocapitalize="off" autocomplete="off" placeholder="Search the docs" maxLength="100"/><ul role="listbox" id="tsd-search-results"></ul><div id="tsd-search-status" aria-live="polite" aria-atomic="true"><div>Preparing search index...</div></div></dialog><a href="#" class="tsd-widget menu" id="tsd-toolbar-menu-trigger" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb" aria-label="Breadcrumb"><li><a href="Handbook.html">Handbook</a></li><li><a href="" aria-current="page">React</a></li></ul></div><div class="tsd-panel tsd-typography"><h1 id="react-hooks" class="tsd-anchor-link">React hooks<a href="#react-hooks" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><p>Subpath export: <code>@karmaniverous/rrstack/react</code></p>
<p>Two small hooks observe a live RRStack instance without re‑wrapping its control surface. RRStack
remains the single source of truth: you call its methods directly; the hooks subscribe to its
post‑mutation notifications.</p>
<h2 id="install--import" class="tsd-anchor-link">Install / import<a href="#install--import" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="ts"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-3">useRRStack</span><span class="hl-1">, </span><span class="hl-3">useRRStackSelector</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-4">&#39;@karmaniverous/rrstack/react&#39;</span><span class="hl-1">;</span><br/><span class="hl-5">import</span><span class="hl-1"> </span><span class="hl-5">type</span><span class="hl-1"> { </span><span class="hl-3">RRStack</span><span class="hl-1">, </span><span class="hl-3">RRStackOptions</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-4">&#39;@karmaniverous/rrstack&#39;</span><span class="hl-1">;</span>
</code><button type="button">Copy</button></pre>

<h2 id="userrstack" class="tsd-anchor-link">useRRStack<a href="#userrstack" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Create (or reset) and observe a live RRStack instance from JSON, with optional debounced change
notifications. Advanced options allow debouncing how edits are applied to RRStack and how renders
are coalesced:</p>
<ul>
<li>mutateDebounce: coalesce frequent UI → rrstack edits (staged + commit).</li>
<li>renderDebounce: coalesce version bumps (rrstack → UI) to reduce repaint churn (optional leading).</li>
<li>changeDebounce: autosave/onChange debounce (always trailing).</li>
</ul>
<p>Signature</p>
<pre><code class="ts"><span class="hl-0">function</span><span class="hl-1"> </span><span class="hl-7">useRRStack</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-3">json</span><span class="hl-1">: </span><span class="hl-9">RRStackOptions</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-7">onChange</span><span class="hl-1">?: (</span><span class="hl-3">s</span><span class="hl-1">: </span><span class="hl-9">RRStack</span><span class="hl-1">) </span><span class="hl-0">=&gt;</span><span class="hl-1"> </span><span class="hl-9">void</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-3">opts</span><span class="hl-1">?: {</span><br/><span class="hl-1">    </span><span class="hl-3">resetKey</span><span class="hl-1">?: </span><span class="hl-9">string</span><span class="hl-1"> | </span><span class="hl-9">number</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-3">changeDebounce</span><span class="hl-1">?: </span><span class="hl-9">true</span><span class="hl-1"> | </span><span class="hl-9">number</span><span class="hl-1"> | { </span><span class="hl-3">delay</span><span class="hl-1">?: </span><span class="hl-9">number</span><span class="hl-1">; </span><span class="hl-3">leading</span><span class="hl-1">?: </span><span class="hl-9">boolean</span><span class="hl-1"> };</span><br/><span class="hl-1">    </span><span class="hl-3">mutateDebounce</span><span class="hl-1">?: </span><span class="hl-9">true</span><span class="hl-1"> | </span><span class="hl-9">number</span><span class="hl-1"> | { </span><span class="hl-3">delay</span><span class="hl-1">?: </span><span class="hl-9">number</span><span class="hl-1">; </span><span class="hl-3">leading</span><span class="hl-1">?: </span><span class="hl-9">boolean</span><span class="hl-1"> };</span><br/><span class="hl-1">    </span><span class="hl-3">renderDebounce</span><span class="hl-1">?: </span><span class="hl-9">true</span><span class="hl-1"> | </span><span class="hl-9">number</span><span class="hl-1"> | { </span><span class="hl-3">delay</span><span class="hl-1">?: </span><span class="hl-9">number</span><span class="hl-1">; </span><span class="hl-3">leading</span><span class="hl-1">?: </span><span class="hl-9">boolean</span><span class="hl-1"> };</span><br/><span class="hl-1">    </span><span class="hl-3">logger</span><span class="hl-1">?:</span><br/><span class="hl-1">      | </span><span class="hl-9">boolean</span><br/><span class="hl-1">      | ((</span><span class="hl-3">e</span><span class="hl-1">: {</span><br/><span class="hl-1">          </span><span class="hl-3">type</span><span class="hl-1">:</span><br/><span class="hl-1">            | </span><span class="hl-4">&#39;init&#39;</span><br/><span class="hl-1">            | </span><span class="hl-4">&#39;reset&#39;</span><br/><span class="hl-1">            | </span><span class="hl-4">&#39;mutate&#39;</span><br/><span class="hl-1">            | </span><span class="hl-4">&#39;commit&#39;</span><br/><span class="hl-1">            | </span><span class="hl-4">&#39;flushChanges&#39;</span><br/><span class="hl-1">            | </span><span class="hl-4">&#39;flushMutations&#39;</span><br/><span class="hl-1">            | </span><span class="hl-4">&#39;flushRender&#39;</span><br/><span class="hl-1">            | </span><span class="hl-4">&#39;cancel&#39;</span><span class="hl-1">;</span><br/><span class="hl-1">          </span><span class="hl-3">rrstack</span><span class="hl-1">: </span><span class="hl-9">RRStack</span><span class="hl-1">;</span><br/><span class="hl-1">        }) </span><span class="hl-0">=&gt;</span><span class="hl-1"> </span><span class="hl-9">void</span><span class="hl-1">);</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">): {</span><br/><span class="hl-1">  </span><span class="hl-3">rrstack</span><span class="hl-1">: </span><span class="hl-9">RRStack</span><span class="hl-1">; </span><span class="hl-6">// façade (proxy)</span><br/><span class="hl-1">  </span><span class="hl-3">version</span><span class="hl-1">: </span><span class="hl-9">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">flushChanges</span><span class="hl-1">: () </span><span class="hl-0">=&gt;</span><span class="hl-1"> </span><span class="hl-9">void</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">flushMutations</span><span class="hl-1">: () </span><span class="hl-0">=&gt;</span><span class="hl-1"> </span><span class="hl-9">void</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">cancelMutations</span><span class="hl-1">: () </span><span class="hl-0">=&gt;</span><span class="hl-1"> </span><span class="hl-9">void</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">flushRender</span><span class="hl-1">: () </span><span class="hl-0">=&gt;</span><span class="hl-1"> </span><span class="hl-9">void</span><span class="hl-1">;</span><br/><span class="hl-1">};</span>
</code><button type="button">Copy</button></pre>

<p>Hook options and outputs (quick reference)</p>
<ul>
<li>Options
<ul>
<li>resetKey: string | number
<ul>
<li>Recreate the RRStack instance intentionally when this value changes (e.g., switching documents).</li>
</ul>
</li>
<li>changeDebounce: true | number | { delay?: number; leading?: boolean }
<ul>
<li>Debounce autosave/onChange; trailing is always true. true = default delay; number = ms delay.</li>
</ul>
</li>
<li>mutateDebounce: true | number | { delay?: number; leading?: boolean }
<ul>
<li>Debounce UI → rrstack edits. Edits to rrstack.rules/timezone are staged and committed once per window.</li>
</ul>
</li>
<li>renderDebounce: true | number | { delay?: number; leading?: boolean }
<ul>
<li>Debounce rrstack → UI paints by coalescing version bumps; final trailing paint always occurs.</li>
</ul>
</li>
<li>logger: boolean | (e: { type: LogEvent; rrstack: RRStack }) =&gt; void
<ul>
<li>true logs to console.debug; function receives structured events.</li>
</ul>
</li>
</ul>
</li>
<li>Outputs
<ul>
<li>rrstack: RRStack (façade)</li>
<li>version: number (incremented on debounced render); use as a memo key for heavy derivations.</li>
<li>flushChanges(): void; flushMutations(): void; cancelMutations(): void; flushRender(): void</li>
</ul>
</li>
</ul>
<p>Parameters</p>
<ul>
<li><code>json: RRStackOptions</code> — JSON input for the stack (same shape as
<code>new RRStack(opts)</code>). A new instance is only created when <code>resetKey</code> changes.- <code>onChange?: (s: RRStack) =&gt; void</code> — optional callback fired after successful
mutations (post‑compile). The constructor does not trigger this callback.</li>
<li><code>opts?:</code> options
<ul>
<li><code>resetKey?: string | number</code> — change to intentionally rebuild the instance
(e.g., switching documents).</li>
<li><code>changeDebounce?: true | number | { delay?: number; leading?: boolean }</code> — autosave debounce.</li>
<li><code>mutateDebounce?: true | number | { delay?: number; leading?: boolean }</code> — coalesce UI edits
into a single commit per window (staged rules/timezone).</li>
<li><code>renderDebounce?: true | number | { delay?: number; leading?: boolean }</code> — coalesce version
bumps (rrstack → UI).</li>
<li><code>logger?: boolean | (e) =&gt; void</code> — <code>true</code> logs basic events via
<code>console.debug</code>; a function receives <code>{ type, rrstack }</code>.</li>
</ul>
</li>
</ul>
<p>Returns</p>
<ul>
<li><code>rrstack: RRStack</code> — façade (proxy) overlaying staged <code>rules/timezone</code> and intercepting mutators.</li>
<li><code>version: number</code> — increments after (debounced) renders; use to memoize heavy derived values.</li>
<li><code>flushChanges(): void</code> — flush pending trailing <code>onChange</code> (autosave).</li>
<li><code>flushMutations(): void</code> — commit staged edits immediately.</li>
<li><code>cancelMutations(): void</code> — discard staged edits.</li>
<li><code>flushRender(): void</code> — flush pending render debounce (force a paint).</li>
</ul>
<p>Behavior notes</p>
<ul>
<li>The hook subscribes to RRStack notifications and schedules the debounced <code>onChange</code> before
notifying React, so <code>flushChanges()</code> can observe a pending trailing call (including with
fake timers).</li>
<li>Debounce state is stable across renders; pending trailing calls persist until delivered or flushed.</li>
<li>RRStack core stays synchronous; debouncing is purely in the hook. <code>mutateDebounce</code> stages edits
and commits once per window. Call <code>flushMutations()</code> when you need rrstack current (e.g., Save).
<code>renderDebounce</code> reduces repaint churn; <code>flushRender()</code> forces an immediate render when needed
(e.g., preview).</li>
</ul>
<p>Example (debounced autosave + “save now”)</p>
<pre><code class="tsx"><span class="hl-0">function</span><span class="hl-1"> </span><span class="hl-7">Editor</span><span class="hl-1">({ </span><span class="hl-3">json</span><span class="hl-1">, </span><span class="hl-3">docId</span><span class="hl-1"> }: { </span><span class="hl-3">json</span><span class="hl-1">: </span><span class="hl-9">RRStackOptions</span><span class="hl-1">; </span><span class="hl-3">docId</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1"> }) {</span><br/><span class="hl-1">  </span><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-7">onChange</span><span class="hl-1"> = (</span><span class="hl-3">s</span><span class="hl-1">: </span><span class="hl-9">RRStack</span><span class="hl-1">) </span><span class="hl-0">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">// autosave (debounced by the hook if configured)</span><br/><span class="hl-1">    </span><span class="hl-0">void</span><span class="hl-1"> </span><span class="hl-7">saveToServer</span><span class="hl-1">(</span><span class="hl-3">docId</span><span class="hl-1">, </span><span class="hl-3">s</span><span class="hl-1">.</span><span class="hl-7">toJson</span><span class="hl-1">());</span><br/><span class="hl-1">  };</span><br/><span class="hl-1">  </span><span class="hl-0">const</span><span class="hl-1"> { </span><span class="hl-2">rrstack</span><span class="hl-1">, </span><span class="hl-2">version</span><span class="hl-1">, </span><span class="hl-2">flushChanges</span><span class="hl-1"> } = </span><span class="hl-7">useRRStack</span><span class="hl-1">(</span><span class="hl-3">json</span><span class="hl-1">, </span><span class="hl-3">onChange</span><span class="hl-1">, {</span><br/><span class="hl-1">    </span><span class="hl-3">resetKey:</span><span class="hl-1"> </span><span class="hl-3">docId</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-3">changeDebounce:</span><span class="hl-1"> </span><span class="hl-8">600</span><span class="hl-1">, </span><span class="hl-6">// autosave (trailing)</span><br/><span class="hl-1">    </span><span class="hl-3">logger:</span><span class="hl-1"> </span><span class="hl-0">true</span><span class="hl-1">,</span><br/><span class="hl-1">  });</span><br/><br/><span class="hl-1">  </span><span class="hl-6">// use version to memoize heavy derived values</span><br/><span class="hl-1">  </span><span class="hl-6">// e.g., segments over a long window</span><br/><br/><span class="hl-1">  </span><span class="hl-5">return</span><span class="hl-1"> (</span><br/><span class="hl-1">    </span><span class="hl-10">&lt;</span><span class="hl-11">div</span><span class="hl-10">&gt;</span><br/><span class="hl-1">      </span><span class="hl-10">&lt;</span><span class="hl-11">button</span><span class="hl-1"> </span><span class="hl-12">onClick</span><span class="hl-1">=</span><span class="hl-0">{</span><span class="hl-13">() </span><span class="hl-0">=&gt;</span><span class="hl-13"> </span><span class="hl-3">rrstack</span><span class="hl-13">.</span><span class="hl-7">addRule</span><span class="hl-13">(</span><span class="hl-6">/*...*/</span><span class="hl-13">)</span><span class="hl-0">}</span><span class="hl-10">&gt;</span><span class="hl-1">Add rule</span><span class="hl-10">&lt;/</span><span class="hl-11">button</span><span class="hl-10">&gt;</span><br/><span class="hl-1">      </span><span class="hl-10">&lt;</span><span class="hl-11">button</span><br/><span class="hl-1">        </span><span class="hl-12">onClick</span><span class="hl-1">=</span><span class="hl-0">{</span><span class="hl-13">() </span><span class="hl-0">=&gt;</span><span class="hl-13"> {</span><br/><span class="hl-13">          </span><span class="hl-7">flushChanges</span><span class="hl-13">();</span><br/><span class="hl-13">          </span><span class="hl-0">void</span><span class="hl-13"> </span><span class="hl-7">saveToServer</span><span class="hl-13">(</span><span class="hl-3">docId</span><span class="hl-13">, </span><span class="hl-3">rrstack</span><span class="hl-13">.</span><span class="hl-7">toJson</span><span class="hl-13">());</span><br/><span class="hl-13">        }</span><span class="hl-0">}</span><br/><span class="hl-1">      </span><span class="hl-10">&gt;</span><br/><span class="hl-1">        Save now</span><br/><span class="hl-1">      </span><span class="hl-10">&lt;/</span><span class="hl-11">button</span><span class="hl-10">&gt;</span><br/><span class="hl-1">      </span><span class="hl-10">&lt;</span><span class="hl-11">div</span><span class="hl-10">&gt;</span><span class="hl-1">Rules: </span><span class="hl-0">{</span><span class="hl-3">rrstack</span><span class="hl-13">.</span><span class="hl-3">rules</span><span class="hl-13">.</span><span class="hl-3">length</span><span class="hl-0">}</span><span class="hl-10">&lt;/</span><span class="hl-11">div</span><span class="hl-10">&gt;</span><br/><span class="hl-1">    </span><span class="hl-10">&lt;/</span><span class="hl-11">div</span><span class="hl-10">&gt;</span><br/><span class="hl-1">  );</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>Leading example</p>
<pre><code class="tsx"><span class="hl-0">const</span><span class="hl-1"> { </span><span class="hl-2">rrstack</span><span class="hl-1"> } = </span><span class="hl-7">useRRStack</span><span class="hl-1">(</span><span class="hl-3">json</span><span class="hl-1">, </span><span class="hl-3">onChange</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-3">changeDebounce:</span><span class="hl-1"> { </span><span class="hl-3">delay:</span><span class="hl-1"> </span><span class="hl-8">200</span><span class="hl-1">, </span><span class="hl-3">leading:</span><span class="hl-1"> </span><span class="hl-0">true</span><span class="hl-1"> },</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<p>Mutate/render debounces example</p>
<pre><code class="tsx"><span class="hl-0">function</span><span class="hl-1"> </span><span class="hl-7">Editor</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-3">json</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-3">docId</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-3">save</span><span class="hl-1">,</span><br/><span class="hl-1">}: {</span><br/><span class="hl-1">  </span><span class="hl-3">json</span><span class="hl-1">: </span><span class="hl-9">RRStackOptions</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-3">docId</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">save</span><span class="hl-1">: (</span><span class="hl-3">j</span><span class="hl-1">: </span><span class="hl-9">RRStackOptions</span><span class="hl-1">) </span><span class="hl-0">=&gt;</span><span class="hl-1"> </span><span class="hl-9">Promise</span><span class="hl-1">&lt;</span><span class="hl-9">void</span><span class="hl-1">&gt;;</span><br/><span class="hl-1">}) {</span><br/><span class="hl-1">  </span><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-7">onChange</span><span class="hl-1"> = (</span><span class="hl-3">s</span><span class="hl-1">: </span><span class="hl-9">RRStack</span><span class="hl-1">) </span><span class="hl-0">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">void</span><span class="hl-1"> </span><span class="hl-7">save</span><span class="hl-1">(</span><span class="hl-3">s</span><span class="hl-1">.</span><span class="hl-7">toJson</span><span class="hl-1">());</span><br/><span class="hl-1">  };</span><br/><span class="hl-1">  </span><span class="hl-0">const</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">rrstack</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-2">flushChanges</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-2">flushMutations</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-2">cancelMutations</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-2">flushRender</span><span class="hl-1">,</span><br/><span class="hl-1">  } = </span><span class="hl-7">useRRStack</span><span class="hl-1">(</span><span class="hl-3">json</span><span class="hl-1">, </span><span class="hl-3">onChange</span><span class="hl-1">, {</span><br/><span class="hl-1">    </span><span class="hl-3">resetKey:</span><span class="hl-1"> </span><span class="hl-3">docId</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-3">changeDebounce:</span><span class="hl-1"> </span><span class="hl-8">600</span><span class="hl-1">, </span><span class="hl-6">// autosave (trailing)</span><br/><span class="hl-1">    </span><span class="hl-3">mutateDebounce:</span><span class="hl-1"> { </span><span class="hl-3">delay:</span><span class="hl-1"> </span><span class="hl-8">150</span><span class="hl-1">, </span><span class="hl-3">leading:</span><span class="hl-1"> </span><span class="hl-0">true</span><span class="hl-1"> }, </span><span class="hl-6">// UI → rrstack</span><br/><span class="hl-1">    </span><span class="hl-3">renderDebounce:</span><span class="hl-1"> { </span><span class="hl-3">delay:</span><span class="hl-1"> </span><span class="hl-8">50</span><span class="hl-1">, </span><span class="hl-3">leading:</span><span class="hl-1"> </span><span class="hl-0">true</span><span class="hl-1"> }, </span><span class="hl-6">// rrstack → UI</span><br/><span class="hl-1">  });</span><br/><br/><span class="hl-1">  </span><span class="hl-6">// Example: stage edits quickly from a form</span><br/><span class="hl-1">  </span><span class="hl-6">// rrstack.updateOptions({ rules: nextRules });</span><br/><br/><span class="hl-1">  </span><span class="hl-5">return</span><span class="hl-1"> (</span><br/><span class="hl-1">    </span><span class="hl-10">&lt;</span><span class="hl-11">div</span><span class="hl-10">&gt;</span><br/><span class="hl-1">      </span><span class="hl-10">&lt;</span><span class="hl-11">button</span><br/><span class="hl-1">        </span><span class="hl-12">onClick</span><span class="hl-1">=</span><span class="hl-0">{</span><span class="hl-13">() </span><span class="hl-0">=&gt;</span><span class="hl-13"> {</span><br/><span class="hl-13">          </span><span class="hl-7">flushMutations</span><span class="hl-13">();</span><br/><span class="hl-13">          </span><span class="hl-7">flushChanges</span><span class="hl-13">();</span><br/><span class="hl-13">        }</span><span class="hl-0">}</span><br/><span class="hl-1">      </span><span class="hl-10">&gt;</span><br/><span class="hl-1">        Save now</span><br/><span class="hl-1">      </span><span class="hl-10">&lt;/</span><span class="hl-11">button</span><span class="hl-10">&gt;</span><br/><span class="hl-1">      </span><span class="hl-10">&lt;</span><span class="hl-11">button</span><br/><span class="hl-1">        </span><span class="hl-12">onClick</span><span class="hl-1">=</span><span class="hl-0">{</span><span class="hl-13">() </span><span class="hl-0">=&gt;</span><span class="hl-13"> {</span><br/><span class="hl-13">          </span><span class="hl-7">flushRender</span><span class="hl-13">();</span><br/><span class="hl-13">        }</span><span class="hl-0">}</span><br/><span class="hl-1">      </span><span class="hl-10">&gt;</span><br/><span class="hl-1">        Force paint</span><br/><span class="hl-1">      </span><span class="hl-10">&lt;/</span><span class="hl-11">button</span><span class="hl-10">&gt;</span><br/><span class="hl-1">      </span><span class="hl-0">{</span><span class="hl-6">/* Provide staged values to your form via rrstack.rules/timezone */</span><span class="hl-0">}</span><br/><span class="hl-1">      </span><span class="hl-0">{</span><span class="hl-6">/* rrstack.toJson() overlays staged values as well */</span><span class="hl-0">}</span><br/><span class="hl-1">    </span><span class="hl-10">&lt;/</span><span class="hl-11">div</span><span class="hl-10">&gt;</span><br/><span class="hl-1">  );</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<h2 id="debounced-form-controls" class="tsd-anchor-link">Debounced form controls<a href="#debounced-form-controls" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>These patterns show how to wire form inputs to RRStack with minimal repaint churn and clean autosave behavior. In both cases, the hook’s mutateDebounce stages edits on the way in and commits once per window; changeDebounce coalesces autosave calls on the way out.</p>
<p>Notes</p>
<ul>
<li>Reads of rrstack.rules/rrstack.timezone (and rrstack.toJson()) reflect staged values prior to commit; queries still use the last committed compiled state until the commit occurs.</li>
<li>For Save now buttons, call flushMutations() then flushChanges() to ensure the latest staged edits are committed and autosaved immediately.</li>
</ul>
<h3 id="uncontrolled-input-debounced-simple" class="tsd-anchor-link">Uncontrolled input (debounced, simple)<a href="#uncontrolled-input-debounced-simple" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Use defaultValue and onInput to keep the input decoupled from React state. Assign directly to rrstack — the façade stages and commits via mutateDebounce.</p>
<pre><code class="tsx"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-3">useEffect</span><span class="hl-1">, </span><span class="hl-3">useRef</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-4">&#39;react&#39;</span><span class="hl-1">;</span><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-3">useRRStack</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-4">&#39;@karmaniverous/rrstack/react&#39;</span><span class="hl-1">;</span><br/><span class="hl-5">import</span><span class="hl-1"> </span><span class="hl-5">type</span><span class="hl-1"> { </span><span class="hl-3">RRStack</span><span class="hl-1">, </span><span class="hl-3">RRStackOptions</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-4">&#39;@karmaniverous/rrstack&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">async</span><span class="hl-1"> </span><span class="hl-0">function</span><span class="hl-1"> </span><span class="hl-7">saveToServer</span><span class="hl-1">(</span><span class="hl-3">json</span><span class="hl-1">: </span><span class="hl-9">RRStackOptions</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-6">// your persistence</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-0">function</span><span class="hl-1"> </span><span class="hl-7">TimeZoneFieldUncontrolled</span><span class="hl-1">({ </span><span class="hl-3">json</span><span class="hl-1"> }: { </span><span class="hl-3">json</span><span class="hl-1">: </span><span class="hl-9">RRStackOptions</span><span class="hl-1"> }) {</span><br/><span class="hl-1">  </span><span class="hl-0">const</span><span class="hl-1"> { </span><span class="hl-2">rrstack</span><span class="hl-1">, </span><span class="hl-2">flushMutations</span><span class="hl-1">, </span><span class="hl-2">flushChanges</span><span class="hl-1"> } = </span><span class="hl-7">useRRStack</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-3">json</span><span class="hl-1">,</span><br/><span class="hl-1">    (</span><span class="hl-3">s</span><span class="hl-1">: </span><span class="hl-9">RRStack</span><span class="hl-1">) </span><span class="hl-0">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">// autosave (debounced by changeDebounce)</span><br/><span class="hl-1">      </span><span class="hl-0">void</span><span class="hl-1"> </span><span class="hl-7">saveToServer</span><span class="hl-1">(</span><span class="hl-3">s</span><span class="hl-1">.</span><span class="hl-7">toJson</span><span class="hl-1">());</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-3">changeDebounce:</span><span class="hl-1"> </span><span class="hl-8">600</span><span class="hl-1">, </span><span class="hl-6">// autosave debounce (trailing)</span><br/><span class="hl-1">      </span><span class="hl-3">mutateDebounce:</span><span class="hl-1"> </span><span class="hl-8">150</span><span class="hl-1">, </span><span class="hl-6">// stage + commit tz/rules once per window</span><br/><span class="hl-1">      </span><span class="hl-6">// optional: renderDebounce: { delay: 50, leading: true },</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  );</span><br/><br/><span class="hl-1">  </span><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">ref</span><span class="hl-1"> = </span><span class="hl-7">useRef</span><span class="hl-1">&lt;</span><span class="hl-9">HTMLInputElement</span><span class="hl-1">&gt;(</span><span class="hl-0">null</span><span class="hl-1">);</span><br/><br/><span class="hl-1">  </span><span class="hl-6">// Keep the uncontrolled input in sync when the source switches (e.g., resetKey) or tz changes externally.</span><br/><span class="hl-1">  </span><span class="hl-7">useEffect</span><span class="hl-1">(() </span><span class="hl-0">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">if</span><span class="hl-1"> (</span><span class="hl-3">ref</span><span class="hl-1">.</span><span class="hl-3">current</span><span class="hl-1">) </span><span class="hl-3">ref</span><span class="hl-1">.</span><span class="hl-3">current</span><span class="hl-1">.</span><span class="hl-3">value</span><span class="hl-1"> = </span><span class="hl-3">rrstack</span><span class="hl-1">.</span><span class="hl-3">timezone</span><span class="hl-1">;</span><br/><span class="hl-1">  }, [</span><span class="hl-3">rrstack</span><span class="hl-1">, </span><span class="hl-3">rrstack</span><span class="hl-1">.</span><span class="hl-3">timezone</span><span class="hl-1">]);</span><br/><br/><span class="hl-1">  </span><span class="hl-5">return</span><span class="hl-1"> (</span><br/><span class="hl-1">    </span><span class="hl-10">&lt;</span><span class="hl-11">form</span><br/><span class="hl-1">      </span><span class="hl-12">onSubmit</span><span class="hl-1">=</span><span class="hl-0">{</span><span class="hl-13">(</span><span class="hl-3">e</span><span class="hl-13">) </span><span class="hl-0">=&gt;</span><span class="hl-13"> {</span><br/><span class="hl-13">        </span><span class="hl-3">e</span><span class="hl-13">.</span><span class="hl-7">preventDefault</span><span class="hl-13">();</span><br/><span class="hl-13">        </span><span class="hl-6">// Ensure latest staged value is committed and autosaved immediately</span><br/><span class="hl-13">        </span><span class="hl-7">flushMutations</span><span class="hl-13">();</span><br/><span class="hl-13">        </span><span class="hl-7">flushChanges</span><span class="hl-13">();</span><br/><span class="hl-13">      }</span><span class="hl-0">}</span><br/><span class="hl-1">    </span><span class="hl-10">&gt;</span><br/><span class="hl-1">      </span><span class="hl-10">&lt;</span><span class="hl-11">label</span><span class="hl-10">&gt;</span><br/><span class="hl-1">        Time zone (uncontrolled):</span><br/><span class="hl-1">        </span><span class="hl-10">&lt;</span><span class="hl-11">input</span><br/><span class="hl-1">          </span><span class="hl-12">ref</span><span class="hl-1">=</span><span class="hl-0">{</span><span class="hl-3">ref</span><span class="hl-0">}</span><br/><span class="hl-1">          </span><span class="hl-12">name</span><span class="hl-1">=</span><span class="hl-4">&quot;tz&quot;</span><br/><span class="hl-1">          </span><span class="hl-12">defaultValue</span><span class="hl-1">=</span><span class="hl-0">{</span><span class="hl-3">rrstack</span><span class="hl-13">.</span><span class="hl-3">timezone</span><span class="hl-0">}</span><br/><span class="hl-1">          </span><span class="hl-12">onInput</span><span class="hl-1">=</span><span class="hl-0">{</span><span class="hl-13">(</span><span class="hl-3">e</span><span class="hl-13">) </span><span class="hl-0">=&gt;</span><span class="hl-13"> {</span><br/><span class="hl-13">            </span><span class="hl-0">const</span><span class="hl-13"> </span><span class="hl-2">next</span><span class="hl-13"> </span><span class="hl-1">=</span><span class="hl-13"> (</span><span class="hl-3">e</span><span class="hl-13">.</span><span class="hl-3">currentTarget</span><span class="hl-13"> </span><span class="hl-5">as</span><span class="hl-13"> </span><span class="hl-9">HTMLInputElement</span><span class="hl-13">).</span><span class="hl-3">value</span><span class="hl-13">;</span><br/><span class="hl-13">            </span><span class="hl-6">// UI → rrstack staging; commit is debounced by mutateDebounce</span><br/><span class="hl-13">            </span><span class="hl-3">rrstack</span><span class="hl-13">.</span><span class="hl-3">timezone</span><span class="hl-13"> </span><span class="hl-1">=</span><span class="hl-13"> </span><span class="hl-3">next</span><span class="hl-13">;</span><br/><span class="hl-13">          }</span><span class="hl-0">}</span><br/><span class="hl-1">        </span><span class="hl-10">/&gt;</span><br/><span class="hl-1">      </span><span class="hl-10">&lt;/</span><span class="hl-11">label</span><span class="hl-10">&gt;</span><br/><span class="hl-1">      </span><span class="hl-10">&lt;</span><span class="hl-11">button</span><span class="hl-1"> </span><span class="hl-12">type</span><span class="hl-1">=</span><span class="hl-4">&quot;submit&quot;</span><span class="hl-10">&gt;</span><span class="hl-1">Save now</span><span class="hl-10">&lt;/</span><span class="hl-11">button</span><span class="hl-10">&gt;</span><br/><span class="hl-1">    </span><span class="hl-10">&lt;/</span><span class="hl-11">form</span><span class="hl-10">&gt;</span><br/><span class="hl-1">  );</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>Why uncontrolled here?</p>
<ul>
<li>Keeps the input snappy without coupling keystrokes to React state.</li>
<li>rrstack’s façade provides the “model” value; mutateDebounce stages updates efficiently.</li>
</ul>
<h3 id="controlled-input-debounced-local-state" class="tsd-anchor-link">Controlled input (debounced, local state)<a href="#controlled-input-debounced-local-state" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Use React state when you need validation, transformation, or dependent UI. Still assign to rrstack on each change — commit is debounced.</p>
<pre><code class="tsx"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-3">useEffect</span><span class="hl-1">, </span><span class="hl-3">useState</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-4">&#39;react&#39;</span><span class="hl-1">;</span><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-3">useRRStack</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-4">&#39;@karmaniverous/rrstack/react&#39;</span><span class="hl-1">;</span><br/><span class="hl-5">import</span><span class="hl-1"> </span><span class="hl-5">type</span><span class="hl-1"> { </span><span class="hl-3">RRStack</span><span class="hl-1">, </span><span class="hl-3">RRStackOptions</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-4">&#39;@karmaniverous/rrstack&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">async</span><span class="hl-1"> </span><span class="hl-0">function</span><span class="hl-1"> </span><span class="hl-7">saveToServer</span><span class="hl-1">(</span><span class="hl-3">json</span><span class="hl-1">: </span><span class="hl-9">RRStackOptions</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-6">// your persistence</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-0">function</span><span class="hl-1"> </span><span class="hl-7">TimeZoneFieldControlled</span><span class="hl-1">({ </span><span class="hl-3">json</span><span class="hl-1"> }: { </span><span class="hl-3">json</span><span class="hl-1">: </span><span class="hl-9">RRStackOptions</span><span class="hl-1"> }) {</span><br/><span class="hl-1">  </span><span class="hl-0">const</span><span class="hl-1"> { </span><span class="hl-2">rrstack</span><span class="hl-1">, </span><span class="hl-2">flushMutations</span><span class="hl-1">, </span><span class="hl-2">cancelMutations</span><span class="hl-1">, </span><span class="hl-2">flushChanges</span><span class="hl-1"> } = </span><span class="hl-7">useRRStack</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-3">json</span><span class="hl-1">,</span><br/><span class="hl-1">    (</span><span class="hl-3">s</span><span class="hl-1">: </span><span class="hl-9">RRStack</span><span class="hl-1">) </span><span class="hl-0">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">void</span><span class="hl-1"> </span><span class="hl-7">saveToServer</span><span class="hl-1">(</span><span class="hl-3">s</span><span class="hl-1">.</span><span class="hl-7">toJson</span><span class="hl-1">());</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-3">changeDebounce:</span><span class="hl-1"> { </span><span class="hl-3">delay:</span><span class="hl-1"> </span><span class="hl-8">600</span><span class="hl-1"> }, </span><span class="hl-6">// autosave (trailing)</span><br/><span class="hl-1">      </span><span class="hl-3">mutateDebounce:</span><span class="hl-1"> { </span><span class="hl-3">delay:</span><span class="hl-1"> </span><span class="hl-8">200</span><span class="hl-1">, </span><span class="hl-3">leading:</span><span class="hl-1"> </span><span class="hl-0">true</span><span class="hl-1"> }, </span><span class="hl-6">// immediate first commit, then trailing</span><br/><span class="hl-1">      </span><span class="hl-3">renderDebounce:</span><span class="hl-1"> { </span><span class="hl-3">delay:</span><span class="hl-1"> </span><span class="hl-8">50</span><span class="hl-1">, </span><span class="hl-3">leading:</span><span class="hl-1"> </span><span class="hl-0">true</span><span class="hl-1"> }, </span><span class="hl-6">// reduce repaint churn</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  );</span><br/><br/><span class="hl-1">  </span><span class="hl-0">const</span><span class="hl-1"> [</span><span class="hl-2">tz</span><span class="hl-1">, </span><span class="hl-2">setTz</span><span class="hl-1">] = </span><span class="hl-7">useState</span><span class="hl-1">(</span><span class="hl-3">rrstack</span><span class="hl-1">.</span><span class="hl-3">timezone</span><span class="hl-1">);</span><br/><br/><span class="hl-1">  </span><span class="hl-6">// Re-sync when the underlying instance resets or external mutations occur.</span><br/><span class="hl-1">  </span><span class="hl-7">useEffect</span><span class="hl-1">(() </span><span class="hl-0">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">setTz</span><span class="hl-1">(</span><span class="hl-3">rrstack</span><span class="hl-1">.</span><span class="hl-3">timezone</span><span class="hl-1">);</span><br/><span class="hl-1">  }, [</span><span class="hl-3">rrstack</span><span class="hl-1">, </span><span class="hl-3">rrstack</span><span class="hl-1">.</span><span class="hl-3">timezone</span><span class="hl-1">]);</span><br/><br/><span class="hl-1">  </span><span class="hl-5">return</span><span class="hl-1"> (</span><br/><span class="hl-1">    </span><span class="hl-10">&lt;</span><span class="hl-11">div</span><span class="hl-10">&gt;</span><br/><span class="hl-1">      </span><span class="hl-10">&lt;</span><span class="hl-11">label</span><span class="hl-10">&gt;</span><br/><span class="hl-1">        Time zone (controlled):</span><br/><span class="hl-1">        </span><span class="hl-10">&lt;</span><span class="hl-11">input</span><br/><span class="hl-1">          </span><span class="hl-12">value</span><span class="hl-1">=</span><span class="hl-0">{</span><span class="hl-3">tz</span><span class="hl-0">}</span><br/><span class="hl-1">          </span><span class="hl-12">onChange</span><span class="hl-1">=</span><span class="hl-0">{</span><span class="hl-13">(</span><span class="hl-3">e</span><span class="hl-13">) </span><span class="hl-0">=&gt;</span><span class="hl-13"> {</span><br/><span class="hl-13">            </span><span class="hl-0">const</span><span class="hl-13"> </span><span class="hl-2">next</span><span class="hl-13"> </span><span class="hl-1">=</span><span class="hl-13"> </span><span class="hl-3">e</span><span class="hl-13">.</span><span class="hl-3">currentTarget</span><span class="hl-13">.</span><span class="hl-3">value</span><span class="hl-13">;</span><br/><span class="hl-13">            </span><span class="hl-7">setTz</span><span class="hl-13">(</span><span class="hl-3">next</span><span class="hl-13">); </span><span class="hl-6">// local echo</span><br/><span class="hl-13">            </span><span class="hl-3">rrstack</span><span class="hl-13">.</span><span class="hl-3">timezone</span><span class="hl-13"> </span><span class="hl-1">=</span><span class="hl-13"> </span><span class="hl-3">next</span><span class="hl-13">; </span><span class="hl-6">// staged; commit debounced by mutateDebounce</span><br/><span class="hl-13">          }</span><span class="hl-0">}</span><br/><span class="hl-1">          </span><span class="hl-12">onBlur</span><span class="hl-1">=</span><span class="hl-0">{</span><span class="hl-13">() </span><span class="hl-0">=&gt;</span><span class="hl-13"> {</span><br/><span class="hl-13">            </span><span class="hl-6">// Make sure a final commit/autosave happens on exit</span><br/><span class="hl-13">            </span><span class="hl-7">flushMutations</span><span class="hl-13">();</span><br/><span class="hl-13">            </span><span class="hl-7">flushChanges</span><span class="hl-13">();</span><br/><span class="hl-13">          }</span><span class="hl-0">}</span><br/><span class="hl-1">        </span><span class="hl-10">/&gt;</span><br/><span class="hl-1">      </span><span class="hl-10">&lt;/</span><span class="hl-11">label</span><span class="hl-10">&gt;</span><br/><span class="hl-1">      </span><span class="hl-10">&lt;</span><span class="hl-11">div</span><span class="hl-1"> </span><span class="hl-12">style</span><span class="hl-1">=</span><span class="hl-0">{</span><span class="hl-13">{ </span><span class="hl-3">display:</span><span class="hl-13"> </span><span class="hl-4">&#39;flex&#39;</span><span class="hl-13">, </span><span class="hl-3">gap:</span><span class="hl-13"> </span><span class="hl-8">8</span><span class="hl-13">, </span><span class="hl-3">marginTop:</span><span class="hl-13"> </span><span class="hl-8">8</span><span class="hl-13"> }</span><span class="hl-0">}</span><span class="hl-10">&gt;</span><br/><span class="hl-1">        </span><span class="hl-10">&lt;</span><span class="hl-11">button</span><br/><span class="hl-1">          </span><span class="hl-12">onClick</span><span class="hl-1">=</span><span class="hl-0">{</span><span class="hl-13">() </span><span class="hl-0">=&gt;</span><span class="hl-13"> {</span><br/><span class="hl-13">            </span><span class="hl-7">flushMutations</span><span class="hl-13">();</span><br/><span class="hl-13">            </span><span class="hl-7">flushChanges</span><span class="hl-13">();</span><br/><span class="hl-13">          }</span><span class="hl-0">}</span><br/><span class="hl-1">        </span><span class="hl-10">&gt;</span><br/><span class="hl-1">          Save now</span><br/><span class="hl-1">        </span><span class="hl-10">&lt;/</span><span class="hl-11">button</span><span class="hl-10">&gt;</span><br/><span class="hl-1">        </span><span class="hl-10">&lt;</span><span class="hl-11">button</span><br/><span class="hl-1">          </span><span class="hl-12">onClick</span><span class="hl-1">=</span><span class="hl-0">{</span><span class="hl-13">() </span><span class="hl-0">=&gt;</span><span class="hl-13"> {</span><br/><span class="hl-13">            </span><span class="hl-7">cancelMutations</span><span class="hl-13">(); </span><span class="hl-6">// discard staged edits</span><br/><span class="hl-13">            </span><span class="hl-7">setTz</span><span class="hl-13">(</span><span class="hl-3">rrstack</span><span class="hl-13">.</span><span class="hl-3">timezone</span><span class="hl-13">); </span><span class="hl-6">// reset local echo</span><br/><span class="hl-13">          }</span><span class="hl-0">}</span><br/><span class="hl-1">        </span><span class="hl-10">&gt;</span><br/><span class="hl-1">          Revert pending</span><br/><span class="hl-1">        </span><span class="hl-10">&lt;/</span><span class="hl-11">button</span><span class="hl-10">&gt;</span><br/><span class="hl-1">      </span><span class="hl-10">&lt;/</span><span class="hl-11">div</span><span class="hl-10">&gt;</span><br/><span class="hl-1">    </span><span class="hl-10">&lt;/</span><span class="hl-11">div</span><span class="hl-10">&gt;</span><br/><span class="hl-1">  );</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<h2 id="userrstackselector" class="tsd-anchor-link">useRRStackSelector<a href="#userrstackselector" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Subscribe to an RRStack‑derived value. The selector recomputes on RRStack
mutations, and the component only re‑renders when <code>isEqual</code> deems the derived
value changed (default <code>Object.is</code>).</p>
<pre><code class="ts"><span class="hl-0">function</span><span class="hl-1"> </span><span class="hl-7">useRRStackSelector</span><span class="hl-1">&lt;</span><span class="hl-9">T</span><span class="hl-1">&gt;(</span><br/><span class="hl-1">  </span><span class="hl-3">rrstack</span><span class="hl-1">: </span><span class="hl-9">RRStack</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-7">selector</span><span class="hl-1">: (</span><span class="hl-3">s</span><span class="hl-1">: </span><span class="hl-9">RRStack</span><span class="hl-1">) </span><span class="hl-0">=&gt;</span><span class="hl-1"> </span><span class="hl-9">T</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-7">isEqual</span><span class="hl-1">?: (</span><span class="hl-3">a</span><span class="hl-1">: </span><span class="hl-9">T</span><span class="hl-1">, </span><span class="hl-3">b</span><span class="hl-1">: </span><span class="hl-9">T</span><span class="hl-1">) </span><span class="hl-0">=&gt;</span><span class="hl-1"> </span><span class="hl-9">boolean</span><span class="hl-1">, </span><span class="hl-6">// default Object.is</span><br/><span class="hl-1">): </span><span class="hl-9">T</span><span class="hl-1">;</span>
</code><button type="button">Copy</button></pre>

<p>Parameters</p>
<ul>
<li><code>rrstack: RRStack</code> — the live instance from <code>useRRStack</code>.</li>
<li><code>selector: (s) =&gt; T</code> — computes the derived value.</li>
<li><code>isEqual?: (a, b) =&gt; boolean</code> — equality check to suppress re‑renders;
default is <code>Object.is</code>.</li>
</ul>
<p>Returns</p>
<ul>
<li><code>T</code> — the derived value, updated when RRStack mutates and <code>isEqual</code> returns
false for the new vs prior value.</li>
</ul>
<p>Example</p>
<pre><code class="tsx"><span class="hl-0">function</span><span class="hl-1"> </span><span class="hl-7">RuleCount</span><span class="hl-1">({ </span><span class="hl-3">json</span><span class="hl-1"> }: { </span><span class="hl-3">json</span><span class="hl-1">: </span><span class="hl-9">RRStackOptions</span><span class="hl-1"> }) {</span><br/><span class="hl-1">  </span><span class="hl-0">const</span><span class="hl-1"> { </span><span class="hl-2">rrstack</span><span class="hl-1"> } = </span><span class="hl-7">useRRStack</span><span class="hl-1">(</span><span class="hl-3">json</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">count</span><span class="hl-1"> = </span><span class="hl-7">useRRStackSelector</span><span class="hl-1">(</span><span class="hl-3">rrstack</span><span class="hl-1">, (</span><span class="hl-3">s</span><span class="hl-1">) </span><span class="hl-0">=&gt;</span><span class="hl-1"> </span><span class="hl-3">s</span><span class="hl-1">.</span><span class="hl-3">rules</span><span class="hl-1">.</span><span class="hl-3">length</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-5">return</span><span class="hl-1"> </span><span class="hl-10">&lt;</span><span class="hl-11">span</span><span class="hl-10">&gt;</span><span class="hl-0">{</span><span class="hl-3">count</span><span class="hl-0">}</span><span class="hl-10">&lt;/</span><span class="hl-11">span</span><span class="hl-10">&gt;</span><span class="hl-1">;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<h2 id="notes--tips" class="tsd-anchor-link">Notes &amp; tips<a href="#notes--tips" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li>Hooks subscribe to RRStack notifications (fired post‑mutation). RRStack remains the single source
of truth; call its methods directly.</li>
<li>For long windows, prefer chunking (day/week) or a Worker for heavy sweeps.</li>
<li>In tests using fake timers, call <code>flushChanges()</code> and/or <code>flushMutations()</code> inside
<code>act(async () =&gt; { ... })</code> and await a microtask to flush effects.</li>
</ul>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg><h3>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg><h3>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#react-hooks"><span>React hooks</span></a><ul><li><a href="#install--import"><span>Install / import</span></a></li><li><a href="#userrstack"><span>use<wbr/>RR<wbr/>Stack</span></a></li><li><a href="#debounced-form-controls"><span>Debounced form controls</span></a></li><li><ul><li><a href="#uncontrolled-input-debounced-simple"><span>Uncontrolled input (debounced, simple)</span></a></li><li><a href="#controlled-input-debounced-local-state"><span>Controlled input (debounced, local state)</span></a></li></ul></li><li><a href="#userrstackselector"><span>use<wbr/>RR<wbr/>Stack<wbr/>Selector</span></a></li><li><a href="#notes--tips"><span>Notes &amp; tips</span></a></li></ul></div></details></div><div class="site-menu"><nav id="tsd-sidebar-links" class="tsd-navigation"><a href="https://github.com/karmaniverous/rrstack" class="tsd-nav-link">GitHub</a></nav><nav class="tsd-navigation"><a href="../modules.html">@karmaniverous/rrstack</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
